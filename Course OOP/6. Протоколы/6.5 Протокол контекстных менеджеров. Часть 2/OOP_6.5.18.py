'''–ö–ª–∞—Å—Å TreeBuilder üå∂Ô∏èüå∂Ô∏è
–î–µ—Ä–µ–≤–æ ‚Äî –æ–¥–Ω–∞ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ, —ç–º—É–ª–∏—Ä—É—é—â–∞—è –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ –≤–∏–¥–µ –Ω–∞–±–æ—Ä–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤.



–≠–ª–µ–º–µ–Ω—Ç—ã –¥–µ—Ä–µ–≤–∞ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —É–∑–ª–∞–º–∏. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ –≤—ã—à–µ —É–∑–ª–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è 8, 3, 1, 6, 4, 7, 10, 14 –∏ 13. –£–∑–ª—ã –±–µ–∑ –ø–æ—Ç–æ–º–∫–æ–≤ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ª–∏—Å—Ç—å—è–º–∏. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ –≤—ã—à–µ –ª–∏—Å—Ç—å—è–º–∏ —è–≤–ª—è—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è 1, 4, 7 –∏ 13.

–†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å TreeBuilder. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–∏–∫–∞–∫–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.

–≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TreeBuilder –¥–æ–ª–∂–µ–Ω —è–≤–ª—è—Ç—å—Å—è —Ä–µ–µ–Ω—Ç–µ—Ä–∞–±–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—à–∞–≥–æ–≤–æ —Å—Ç—Ä–æ–∏—Ç—å –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö (–¥–µ—Ä–µ–≤–æ).

–ö–ª–∞—Å—Å TreeBuilder –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–≤–∞ –º–µ—Ç–æ–¥–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞:

add() ‚Äî –º–µ—Ç–æ–¥, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç (–ª–∏—Å—Ç) –∏ –¥–æ–±–∞–≤–ª—è—é—â–∏–π –µ–≥–æ –≤ —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª –¥–µ—Ä–µ–≤–∞
structure() ‚Äî –º–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–µ—Ä–µ–≤–∞ –≤ –≤–∏–¥–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤ –≤ –¥–µ—Ä–µ–≤–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ with. –£–∑–µ–ª —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–º –≤ —Ä–∞–º–∫–∞—Ö —Å–≤–æ–µ–≥–æ –±–ª–æ–∫–∞ with. –ï—Å–ª–∏ –≤ —É–∑–µ–ª –Ω–µ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –ª–∏—Å—Ç–∞, —Ç–æ —ç—Ç–æ—Ç —É–∑–µ–ª –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–ª—è—Ç—å—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–µ—Ä–µ–≤–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–π –º–µ—Ç–æ–¥–æ–º structure().

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π, —Ç–æ –µ—Å—Ç—å —É–∑–µ–ª –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥—Ä—É–≥–æ–π —É–∑–µ–ª, —Ç–æ—Ç, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –¥—Ä—É–≥–æ–π, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤ with, —Ç–æ –µ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è –ª–∏—à—å –ø–æ—Å–ª–µ –µ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 3. –ù–∞–≥–ª—è–¥–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ TreeBuilder –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 5. –ö–ª–∞—Å—Å TreeBuilder –¥–æ–ª–∂–µ–Ω —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —Ç–æ –µ—Å—Ç—å –∏–º–µ—Ç—å –º–µ—Ç–æ–¥—ã __enter__() –∏ __exit__(). –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∂–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 6. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å—Å—ã–ª–∫–∞–º:
https://github.com/python-generation/OOP/tree/main/Module_6/Module_6.5/Module_6.5.18
'''

class TreeBuilder:
    def __init__(self):
        self.tree = {}
        self.l = []
    level = 0
    def __enter__(self):
        self.tree.setdefault(type(self).level, [])
        type(self).level += 1

    def add(self, node):
        self.tree.setdefault(type(self).level, []).append(node)

    def __exit__(self, *args, **kwargs):
        temp = self.tree[type(self).level]
        self.tree[type(self).level] = []
        if temp:
            self.tree[type(self).level-1].append(temp)
        type(self).level -= 1

    def structure(self):
        if self.tree:
            return self.tree[0]
        else:
            return []

    # def add(self, node):
    #     self.tree.append(node)
    # def structure(self):
    #     return self.tree
    #
    # def __enter__(self):
    #     return self
    # def __exit__(self, *args):
    #     return False


# INPUT DATA:

# TEST_1:
tree = TreeBuilder()
print(tree.structure())

tree.add('1st')
print(tree.structure())

with tree:
    tree.add('2nd')
    with tree:
        tree.add('3rd')
    tree.add('4th')
    with tree:
        pass

print(tree.structure())

# TEST_2:
tree = TreeBuilder()

tree.add('1st')

with tree:
    tree.add('2nd')
    with tree:
        tree.add('3rd')
        with tree:
            tree.add('4th')
            with tree:
                tree.add('5th')
    with tree:
        pass

tree.add('6th')
print(tree.structure())

# TEST_3:
tree = TreeBuilder()

with tree:
    tree.add(1)
    tree.add(2)
    with tree:
        tree.add(3)
        with tree:
            tree.add(4)
    with tree:
        tree.add(5)

print(tree.structure())

# TEST_4:
tree = TreeBuilder()

with tree:
    tree.add(1)
    with tree:
        tree.add(2)
        tree.add(3)
    with tree:
        pass

print(tree.structure())

# TEST_5:
tree = TreeBuilder()

tree.add(0)
print(tree.structure())

with tree:
    tree.add(1)
    with tree:
        tree.add(2)
        tree.add(3)
        with tree:
            tree.add(4)
    with tree:
        pass

print(tree.structure())

with tree:
    tree.add(5)
    with tree:
        tree.add(6)
    with tree:
        tree.add(7)
        with tree:
            tree.add(8)

print(tree.structure())

# TEST_6:
tree = TreeBuilder()

tree.add('root')
with tree:
    tree.add('first child')
    tree.add('second child')
    with tree:
        tree.add('grandchild')
    tree.add('bastard')
    with tree:
        pass
    tree.add('another bastard')

print(tree.structure())

# TEST_7:
tree = TreeBuilder()

tree.add('1st')

with tree:
    with tree:
        with tree:
            with tree:
                tree.add('5th')

print(tree.structure())

# TEST_8:
tree1 = TreeBuilder()
tree2 = TreeBuilder()

tree1.add('1st')

with tree1:
    tree1.add('2nd')
    with tree1:
        tree1.add('3rd')
    tree1.add('4th')
    with tree1:
        pass

print(tree1.structure())
print(tree2.structure())